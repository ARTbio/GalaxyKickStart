galaxy_changeset_id: release_21.05
configure_docker: no

galaxy_hostname: "mississippi.sorbonne-universite.fr"

#persistent data
galaxy_persistent_directory: /mnt/data/mississippi_galaxy_persist

galaxy_tools_tool_list_files: 
  - "extra-files/Mississippi/mississippi_tool_list.yml"
additional_files_list:
  - { src: "extra-files/Mississippi/welcome.html", dest: "{{ galaxy_server_dir }}/static/" }
  - { src: "extra-files/Mississippi/ARTbio_mississippi_screen.jpg", dest: "{{ galaxy_server_dir }}/static/images/" }
  - { src: "extra-files/Mississippi/mississippi_logo.png", dest: "{{ galaxy_server_dir }}/static/images/" }
  - { src: "extra-files/Mississippi/IBPS_logo.jpg", dest: "{{ galaxy_server_dir }}/static/images/" }
  - { src: "extra-files/Mississippi/job_conf.xml", dest: "{{ galaxy_config_dir }}" }
  - { src: "extra-files/tool_sheds_conf.xml", dest: "{{ galaxy_config_dir }}" }
# specific ie for ipython and rstudio
galaxy_extras_ie_fetch_jupyter: true
galaxy_extras_ie_jupyter_image: quay.io/bgruening/docker-jupyter-notebook:17.09
galaxy_extras_ie_fetch_rstudio: true
galaxy_extras_ie_rstudio_image: artbio/rstudio-notebook:latest

galaxy_admin: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          30666436643132326638306436363431306134626333303436313334326430636664386562653665
          3262363362373665323065316435653335383862353765310a303561336439313635633334666336
          65323662343339653237343038336437356136356561353930636331346361623961663737353336
          6264323365343837320a353733633836613034303165313535353263316434333162616332396333
          32356336376361343132386531376338636462663330653337633432323634336265

galaxy_admin_pw: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          31313333363238393636306334336161356261623939623332306263636231396562613265356634
          6132663566393931646535316437383335643665353131640a323064663438353661393735633238
          37336238646666626138633033666232313931616236613262386165643063346164306331336565
          6466356231323033650a316664323866336436343335623533393862343539316334653631383432
          6232

# extras to galaxy-config
# galaxy_config['galaxy']['shed_tool_config_file']: shed_tool_conf.xml

galaxy_config:
  "uwsgi":
    # other uwsgi option are defaulted in ansible-galaxy-os role
    module: galaxy.webapps.galaxy.buildapp:uwsgi_app()
    # warning the above line should be dropped when prefixing
    # upon guide-lines in  https://docs.galaxyproject.org/en/latest/admin/nginx.html
    logfile-chmod: 644
  'galaxy':
    filter-with: proxy-prefix
    prefix: "{{ nginx_galaxy_location }}" # this is not clear from the galaxy.yml.sample which in addition is not consistent with https://docs.galaxyproject.org/en/latest/admin/nginx.html
    admin_users: "{{ galaxy_admin }}"
    database_connection: "{{ galaxy_db }}"
    tool_dependency_dir: "{{ tool_dependency_dir }}"
    ftp_upload_dir: "{{ proftpd_files_dir }}"
    ftp_upload_site: "ftp://{{ ipify_public_ip }}"
    allow_user_dataset_purge: True
    allow_user_impersonation: True
    enable_quotas: True
    allow_user_deletion: True
    allow_library_path_paste: True
    tool_sheds_config_file: "{{ galaxy_config_dir }}/tool_sheds_conf.xml"
    static_enabled: False
    watch_tool_data_dir: True
    use_pbkdf2: "{{ use_pbkdf2 }}"
    len_file_path: "{{ galaxy_config_dir }}/len"
    nginx_x_accel_redirect_base: /_x_accel_redirect
    interactive_environment_plugins_directory: config/plugins/interactive_environments
    visualization_plugins_directory: config/plugins/visualizations
    # interactive environments - set dynamic_proxy_manage to true #
    dynamic_proxy_manage: true
    dynamic_proxy_session_map: database/session_map.sqlite
    dynamic_proxy_bind_port: 8800
    dynamic_proxy_bind_ip: 0.0.0.0
    dynamic_proxy_debug: true
    dynamic_proxy_external_proxy: true
    dynamic_proxy_prefix: gie_proxy
    expose_potentially_sensitive_job_metrics: true
    require_login: true
    smtp_server: 'smtp.gmail.com:587'
    smtp_username: !vault |
        $ANSIBLE_VAULT;1.1;AES256
        30303037333761313362393135643836313237656236613333386534353637333735373637303930
        3631386161306637653438613662626361363233396230390a383233666534363464353963663238
        37336466633331653236356265323233383264383038616634636630396435656133333632343035
        3166313364326536370a643665303261373732303531306633313363343663656338663162313834
        36306332316439323831396664356132333163383961613333626439643862303461
    smtp_password: !vault |
        $ANSIBLE_VAULT;1.1;AES256
        32623038356232393039326135613262303533623061353832633634623062643035326465303833
        3436376335376533353432626238326130633861353065380a353864613435663037333530356538
        64303931313337626439616238666362623463623366373437366130396134356163386335396232
        3137393736623466650a376562383837313465386232336533336363653135636563393032346561
        6436
    error_email_to: gedserver@gmail.com

# ssl certificate (from digicert) for https
galaxy_extras_config_ssl: true
galaxy_extras_config_ssl_method: own

src_nginx_ssl_certificate_key: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          32396464326631356333663965366363333764333465366330656639353137643038386436633830
          3630626239623438343234343735336530313838626233610a353434316639316565303438666232
          65636530633437303532373538643163666433363961383335633564386165663863633765386131
          6361636638633266650a303532346163333634336538323738663461393239366331333439376461
          30633232313666646261326437343931316131396563616165333339393833616630383065626536
          30306265396335363033616433623036643831633837336261653634386437666362336235323266
          393038643330363230333533323937323331
src_nginx_ssl_certificate: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          35623461633938383035366562646133653833323933623337643133313466643561626636323162
          3063306263336235626438396363663034613436646637660a656463653631393865613262326663
          38323836373466633233326332373666613639653837616663376231336265336436366466393639
          3636613032386330650a313539363236656637323839336439623764623239633864613064383435
          37316566663835306136656439616665346330383333373837633662316162616663373863303562
          36383361643863343537636464326466333131343132336536646235316538633333346363623530
          663239393663313338306334343162393332
nginx_ssl_certificate_key: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          35646538386463376437316436313433663733336264376437353939313266393833393938663933
          6366636563663763616338393134623531366532363733310a373732623039313166666362326433
          37663636616536366665636333353139386166356162393864383366353866623666653539313366
          6536336237343936320a383931653035306238396365376362663631623564306432326564336135
          36303562353936306163626563636438643666306462613366633437623565376563643833643161
          63303235313631316366346439313365353066396463353435396535623235653638336562386239
          633336393633313834323864666637316162
nginx_ssl_certificate: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          35613038646464613032663861353362346237313936656235303631396138346138333864313337
          3033613932643236336138366530336563346163663037640a663234386361326465353234353539
          38373066346535366464343362666538353363666530333231666434626138303937633034653662
          3933363362396164360a666666303061356636616334623130343632653030313439313864373230
          30663265393565626233396532393065643133663533316136383535306536303634306436363039
          35643232353363613039626436633237396238373830656136383337363064656133313837326163
          333265313931653364616432323233653936

galaxy_extras_config_galaxy_job_metrics: true

