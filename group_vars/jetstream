jetstream: true

configure_docker: no
install_apparmor: no
install_galaxy: yes
run_extras: yes
install_tools: yes
run_data_manager: no

# A custom config needs be supplied before Reports will work
supervisor_manage_reports: no

default_user_name: ubuntu

galaxy_uwsgi: no
galaxy_uwsgi_static_conf: no
galaxy_extras_config_uwsgi: no
galaxy_web_processes: 1
galaxy_handler_processes: 0

galaxyFS_base_dir: /opt/galaxy
galaxy_server_dir: "{{ galaxyFS_base_dir }}/galaxy-app"
galaxy_config_dir: "{{ galaxy_server_dir }}/config"
galaxy_log_dir: "{{ galaxyFS_base_dir }}/logs"
galaxy_venv_dir: "{{ galaxy_server_dir }}/.venv"
galaxy_data: "{{ galaxyFS_base_dir }}/galaxy"
galaxy_database: "{{ galaxyFS_base_dir }}/db"
galaxy_shed_tools_dir: "{{ galaxyFS_base_dir }}/shed_tools"
galaxy_tools_tool_list_files: ["extra-files/jetstream/jetstream_data_manager_tool_list.yml"]
# galaxy_tools_tool_list_files: ["extra-files/jetstream/usegalaxy_main_tool_list.yml"]
tool_dependency_dir: "{{ galaxyFS_base_dir }}/tool_dependencies"
data_manager_task_file: "extra-files/jetstream/jetstream_data_manager_tasks.yml"
len_file_path: "{{ galaxy_config_dir }}/len"
galaxy_custom_tools_dir: /usr/local/bin

galaxy_git_repo: https://github.com/galaxyproject/galaxy.git
galaxy_changeset_id: release_16.07

proftpd_files_dir: "{{ galaxyFS_base_dir }}/tmp/ftp"
supervisor_slurm_config_dir: "{{ galaxyFS_base_dir }}/logs"
additional_files_list:
  - { src: "extra-files/jetstream/tool_sheds_conf.xml", dest: "{{ galaxy_config_dir }}" }
  - { src: "extra-files/jetstream/fix_hostname.sh", dest: "/usr/local/bin/fix_hostname.sh" }
  - { src: "extra-files/jetstream/welcome.html", dest: "{{ galaxy_server_dir }}/static/" }
  - { src: "extra-files/jetstream/jetstream_text.png", dest: "{{ galaxy_server_dir }}/static/images/" }
  - { src: "extra-files/jetstream/cloud.gif", dest: "{{ galaxy_server_dir }}/static/images/" }
  - { src: "extra-files/jetstream/vimrc", dest: "/etc/vim/" }

galaxy_config_files:
  - src: extra-files/jetstream/builds.txt
    dest: "{{ galaxy_config['app:main']['builds_file_path'] }}"
  - src: extra-files/jetstream/shed_tool_conf.xml.cloud
    dest: "{{ galaxy_config_dir }}/shed_tool_conf_cloud.xml"

galaxy_mutable_configs:
  - src: "{{ galaxy_server_dir }}/config/shed_tool_conf.xml.sample"
    dest: "{{ galaxy_shed_tool_conf_file }}"
  - src: "{{ galaxy_server_dir }}/config/shed_tool_data_table_conf.xml.sample"
    dest: "{{ galaxy_config['app:main']['shed_tool_data_table_config'] if galaxy_config is defined and 'app:main' in galaxy_config and 'shed_tool_data_table_config' in galaxy_config['app:main'] else galaxy_config_default['app:main']['shed_tool_data_table_config'] }}"
  - src: "{{ galaxy_server_dir }}/config/shed_data_manager_conf.xml.sample"
    dest: "{{ galaxy_config['app:main']['shed_data_manager_config_file'] if galaxy_config is defined and 'app:main' in galaxy_config and 'shed_data_manager_config_file' in galaxy_config['app:main'] else galaxy_config_default['app:main']['shed_data_manager_config_file'] }}"
  - src: "{{ galaxy_server_dir }}/config/datatypes_conf.xml.sample"
    dest: "{{ galaxy_config['app:main']['datatypes_config_file'] if galaxy_config is defined and 'app:main' in galaxy_config and 'datatypes_config_file' in galaxy_config['app:main'] else galaxy_config_default['app:main']['datatypes_config_file'] }}"
  - src: "{{ galaxy_server_dir }}/config/tool_data_table_conf.xml.sample"
    dest: "{{ galaxy_config['app:main']['tool_data_table_config_path'] }}"
  - src: "{{ galaxy_server_dir }}/config/tool_conf.xml.sample"
    dest: "{{ galaxy_config_dir }}/tool_conf.xml"
  - src: "{{ galaxy_server_dir }}/config/migrated_tools_conf.xml.sample"
    dest: "{{ galaxy_config['app:main']['migrated_tools_config'] if galaxy_config is defined and 'app:main' in galaxy_config and 'migrated_tools_config' in galaxy_config['app:main'] else galaxy_config_default['app:main']['migrated_tools_config'] }}"
  - src: "{{ galaxy_server_dir }}/config/datatypes_conf.xml.sample"
    dest: "{{ galaxy_config['app:main']['datatypes_config_file'] if galaxy_config is defined and 'app:main' in galaxy_config and 'datatypes_config_file' in galaxy_config['app:main'] else galaxy_config_default['app:main']['datatypes_config_file'] }}"


cvmfs_deb_url: "https://ecsft.cern.ch/dist/cvmfs/cvmfs-2.1.20/cvmfs_2.1.20_amd64.deb"
cvmfs_deb_config_url: "https://ecsft.cern.ch/dist/cvmfs/cvmfs-config/cvmfs-config-default_latest_all.deb"
cvmfs_keys:
  - path: /etc/cvmfs/keys/test.galaxyproject.org.pub
    key: |
      -----BEGIN PUBLIC KEY-----
      MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAtfc5SSX9ALcrukWYcxkI
      mkLhlkJa5tCP1oZNWFA7GfE4xQW2vcKE5qmbZqhYVfdiy+FHPnhWPJp577hekD2F
      vMITbApdZ0265AjRC0+EKKxpMF8zZ0q71vCFxvdK0c3DtT/3LmqKrr2wimtJZjQN
      UAZcQG2ykzeHzFZ46w74IO0o8Fv/w2XEbYI0QqbNFv+0hcp5SruFqaaLsRZdd6Bn
      3iSylgVRQ5b+h1LfB/EuEpSmH1sDozZ4tU0fpbrBSknK76aad1o/cvWY1X87ToUV
      helU0HE2Rw/u9EqJDvPFTbUmad3MtspkqbG5Eo7lI+ktzbcD7UTsQ/7noIXIQ5dD
      PwIDAQAB
      -----END PUBLIC KEY-----
  - path: /etc/cvmfs/keys/data.galaxyproject.org.pub
    key: |
      -----BEGIN PUBLIC KEY-----
      MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5LHQuKWzcX5iBbCGsXGt
      6CRi9+a9cKZG4UlX/lJukEJ+3dSxVDWJs88PSdLk+E25494oU56hB8YeVq+W8AQE
      3LWx2K2ruRjEAI2o8sRgs/IbafjZ7cBuERzqj3Tn5qUIBFoKUMWMSIiWTQe2Sfnj
      GzfDoswr5TTk7aH/FIXUjLnLGGCOzPtUC244IhHARzu86bWYxQJUw0/kZl5wVGcH
      maSgr39h1xPst0Vx1keJ95AH0wqxPbCcyBGtF1L6HQlLidmoIDqcCQpLsGJJEoOs
      NVNhhcb66OJHah5ppI1N3cZehdaKyr1XcF9eedwLFTvuiwTn6qMmttT/tHX7rcxT
      owIDAQAB
      -----END PUBLIC KEY-----

cvmfs_server_urls:
  - domain: galaxyproject.org
    urls:
      - "http://cvmfs1-tacc0.galaxyproject.org/cvmfs/@fqrn@"

cvmfs_repositories:
  # - test.galaxyproject.org
  - data.galaxyproject.org

cvmfs_http_proxies:
  - "http://cvmfs1-tacc0.galaxyproject.org:3128"

