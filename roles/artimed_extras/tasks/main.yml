- name: Create proftpd dir
  file: path="{{ galaxy_ftp }}" state=directory mode=0777
  sudo: yes
  sudo_user: "{{ galaxy_user }}"

- name: Manage templates for galaxy and proftpd
  template: src={{ item.src }} dest={{ item.dest }} backup=no
  with_items:
    - { src: "welcome.html", dest: "{{ galaxy_server_dir }}/static/" }
    - { src: "tool_sheds_conf.xml", dest: "{{ galaxy_config_dir }}" }
    - { src: "proftpd.conf.j2", dest: "{{ proftpd_conf_path }}" }

- name:  Provide Galaxy images for the homepage
  copy: src={{ item.src }} dest={{ item.dest }} owner=galaxy
  with_items:
    - { src: "ARTiMED_logo.png", dest: "{{ galaxy_server_dir }}/static/images/" }
    - { src: "logo_iuis_UPMC_UTC.jpg", dest: "{{ galaxy_server_dir }}/static/images/" }

- name: Restart proftpd
  supervisorctl: name=proftpd state=restarted

#- name: Create Proftpd configuration file
#  template: src=proftpd.conf.j2 dest={{ proftpd_conf_path }}

#- name: Manage available tool sheds 
#  template: src=tool_sheds_conf.xml.j2 dest={{ galaxy_config_dir }} backup=yes

#- name: Activate custom welcome.html
#  template: src=welcome.html.j2 dest={{ galaxy_server_dir }}/static/ backup=yes


